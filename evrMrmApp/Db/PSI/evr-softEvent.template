# Mapping between hardware event code and a software (EPICS) database event
#
# Macros:
#  SYS = System name
#  EVR = EVR devObj name
#  EVT = Event code (hardware). Set EVT=0 to disable.
#  CODE = EPICS database event number (software)
#
#
record(longout, "$(SYS)-$(EVR):Event-$(EVT)-SP") {
  field(DTYP, "EVR Event")
  field(SCAN, "I/O Intr")
  field(OUT , "@OBJ=$(EVR),Code=$(EVT)")
  #field(VAL , "$(CODE)")
  field(VAL , "-1")
  field(TSE , "-2") # from device support
  field(FLNK, "$(SYS)-$(EVR):Event-$(EVT)-Trig")
  info(autosaveFields_pass0, "OUT VAL")
}

record(event, "$(SYS)-$(EVR):Event-$(EVT)-Trig") {
  field(VAL , "$(CODE)")
  field(FLNK, "$(SYS)-$(EVR):Event-$(EVT)-Cnt-I")
}

record(calc, "$(SYS)-$(EVR):Event-$(EVT)-Cnt-I") {
  field(SDIS, "$(SYS)-$(EVR):Event-$(EVT)-SP")
  field(DISV, "0")
  field(CALC, "A+1")
  field(INPA, "$(SYS)-$(EVR):Event-$(EVT)-Cnt-I NPP")
  field(TSEL, "$(SYS)-$(EVR):Event-$(EVT)-SP.TIME")
  field(LOLO, "0")
  field(LLSV, "MINOR")
}
